<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Business Capability Map Generator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --blue1: #3674B5;
            --blue2: #578FCA;
            --yellow1: #FADA7A;
            --cream: #F5F0CD;
        }
        body {
            margin: 0;
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(120deg, var(--blue2) 0%, var(--cream) 100%);
            min-height: 100vh;
            color: #222;
        }
        .hero {
            background: linear-gradient(120deg, var(--blue1) 0%, var(--blue2) 100%);
            color: var(--cream);
            padding: 64px 0 48px 0;
            text-align: center;
            box-shadow: 0 4px 32px #0002;
        }
        .hero h1 {
            font-size: 2.8em;
            font-weight: 800;
            margin-bottom: 0.2em;
            letter-spacing: -1px;
        }
        .hero p {
            font-size: 1.3em;
            margin-bottom: 1.5em;
            color: var(--yellow1);
        }
        .cta-btn {
            background: var(--yellow1);
            color: var(--blue1);
            border: none;
            border-radius: 8px;
            padding: 18px 38px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 2px 8px #0001;
            transition: background 0.2s;
        }
        .cta-btn:hover {
            background: #ffe08a;
        }
        .trust {
            margin-top: 2em;
            font-size: 1em;
            color: var(--cream);
            opacity: 0.85;
        }
        .features-section {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
            gap: 48px;
            background: var(--cream);
            padding: 48px 0 32px 0;
        }
        .features {
            max-width: 420px;
            margin: 0 24px;
        }
        .features h2 {
            color: var(--blue1);
            font-size: 2em;
            margin-bottom: 0.5em;
        }
        .features ul {
            list-style: none;
            padding: 0;
            margin: 0 0 1.5em 0;
        }
        .features ul li {
            margin-bottom: 0.7em;
            font-size: 1.1em;
            display: flex;
            align-items: center;
        }
        .features ul li i {
            color: var(--blue2);
            margin-right: 10px;
        }
        .sample-img {
            background: var(--yellow1);
            border-radius: 18px;
            box-shadow: 0 2px 16px #0002;
            width: 340px;
            height: 220px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            color: var(--blue1);
            margin: 0 24px;
        }
        .generator-section {
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 2px 16px #0002;
            max-width: 700px;
            margin: 48px auto 32px auto;
            padding: 36px 32px 32px 32px;
        }
        .generator-section h2 {
            color: var(--blue1);
            text-align: center;
            margin-bottom: 1.2em;
        }
        .footer {
            text-align: center;
            color: var(--blue2);
            font-size: 1em;
            padding: 24px 0 16px 0;
            background: var(--cream);
        }
        @media (max-width: 900px) {
            .features-section { flex-direction: column; align-items: center; }
            .sample-img { margin: 32px 0 0 0; }
        }
        .bcm-upload-card {
            display: flex;
            background: var(--cream);
            border-radius: 18px;
            box-shadow: 0 2px 16px #0002;
            padding: 32px 24px;
            gap: 32px;
            align-items: flex-start;
            margin-bottom: 32px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        .bcm-upload-drop {
            flex: 1;
            min-width: 220px;
            min-height: 220px;
            border: 2px dashed var(--blue2);
            border-radius: 16px;
            background: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: border-color 0.2s;
            padding: 18px 12px;
        }
        .bcm-upload-drop.dragover {
            border-color: var(--blue1);
            background: var(--yellow1);
        }
        .upload-icon {
            font-size: 40px;
            color: var(--blue1);
            margin-bottom: 12px;
        }
        .bcm-upload-text {
            color: var(--blue1);
            font-size: 1.1em;
            margin-bottom: 4px;
        }
        .bcm-browse-btn {
            background: var(--blue1);
            color: #fff;
            border: none;
            border-radius: 6px;
            padding: 10px 24px;
            font-size: 1em;
            cursor: pointer;
            margin-top: 8px;
            transition: background 0.2s;
        }
        .bcm-browse-btn:hover {
            background: var(--blue2);
        }
        .bcm-upload-drop input[type="file"] {
            display: none;
        }
        .bcm-upload-list {
            flex: 1;
            min-width: 180px;
            margin-left: 24px;
        }
        .bcm-upload-list-title {
            font-weight: bold;
            color: var(--blue1);
            margin-bottom: 10px;
        }
        .bcm-upload-file-item {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--yellow1);
            border-radius: 8px;
            padding: 8px 12px;
            margin-bottom: 8px;
            font-size: 1em;
            color: var(--blue1);
            box-shadow: 0 1px 4px #0001;
        }
        .bcm-upload-file-icon {
            font-size: 1.2em;
            color: var(--blue2);
        }
        .bcm-upload-file-name {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .bcm-upload-delete-btn {
            background: none;
            border: none;
            color: #e53935;
            font-size: 1.1em;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 4px;
            transition: background 0.2s;
        }
        .bcm-upload-delete-btn:hover {
            background: #ffeaea;
        }
        .generate-btn {
            background: var(--blue1);
            color: #fff;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 24px;
            width: 100%;
            box-shadow: 0 2px 8px #0001;
            transition: background 0.2s, transform 0.1s;
            padding: 18px 0;
            letter-spacing: 0.5px;
        }
        .generate-btn:hover {
            background: var(--blue2);
            transform: translateY(-2px) scale(1.03);
        }
        .generate-btn-big {
            font-size: 1.6em;
            padding: 28px 0;
            margin-top: 36px;
            border-radius: 16px;
            box-shadow: 0 4px 16px #0002;
        }
        .generate-btn-full {
            width: calc(100% + 48px);
            margin-left: -24px;
            margin-right: -24px;
            border-radius: 0 0 16px 16px;
            display: block;
        }
        .bcm-font-select {
            width: 100%;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid var(--blue2);
            font-size: 1.1em;
            margin-top: 4px;
            margin-bottom: 0;
            background: #fff;
            color: var(--blue1);
        }
        .bcm-font-select:focus {
            outline: 2px solid var(--blue2);
        }
    </style>
</head>
<body>
    <div class="hero">
        <h1>Business Capability Map Generator</h1>
        <p>Upload your Excel, customize your style, and generate a beautiful capability map in PowerPoint.<br>
        <span style="color: var(--cream); font-size: 0.9em;">No signup required. 100% free & private.</span></p>
        <button class="cta-btn" onclick="document.getElementById('bcmForm').scrollIntoView({behavior: 'smooth'})">Start Now</button>
        <div class="trust">Trusted by business architects, consultants, and transformation teams.</div>
    </div>
    <div class="features-section">
        <div class="features">
            <h2>Why use this tool?</h2>
            <ul>
                <li><i class="fa-solid fa-bolt"></i> Fast: From Excel to PowerPoint in seconds</li>
                <li><i class="fa-solid fa-palette"></i> Customizable: Colors, fonts, box sizes, and more</li>
                <li><i class="fa-solid fa-lock"></i> Secure: Your data stays on your device</li>
                <li><i class="fa-solid fa-download"></i> Free: No signup, no hidden costs</li>
            </ul>
            <p>Visualize your business capabilities instantly. Just upload your Excel, adjust the look, and download your ready-to-use PowerPoint map.</p>
        </div>
        <div class="sample-img">
            <img src="/static/sample_bcm_map.jpg" alt="Sample Business Capability Map" style="width:100%;height:auto;border-radius:14px;box-shadow:0 2px 16px #0002;">
        </div>
    </div>
    <div class="generator-section">
        <h2>Generate your Capability Map</h2>
        <div class="bcm-upload-card">
            <div class="bcm-upload-drop" id="uploadArea">
                <i class="fa-solid fa-cloud-arrow-up upload-icon"></i>
                <div class="bcm-upload-text">Drag and Drop file to upload</div>
                <div style="margin: 8px 0; color: var(--blue2);">or</div>
                <button type="button" class="bcm-browse-btn" onclick="document.getElementById('excelFile').click()">Browse</button>
                <input type="file" id="excelFile" name="excelFile" accept=".xlsx,.xls" onchange="handleFileSelect(event)">
                <small style="color: var(--blue2); margin-top: 10px; display: block;">Supported format: .XLSX, .XLS</small>
            </div>
            <div class="bcm-upload-list">
                <div class="bcm-upload-list-title">Uploaded File</div>
                <div id="fileList"></div>
                <form id="bcmForm" onsubmit="generatePresentation(event)" enctype="multipart/form-data" class="bcm-form-section">
                    <div class="row">
                        <div>
                            <label for="fontSizeLevel1">Font Size Level 1</label>
                            <input type="number" id="fontSizeLevel1" value="12" min="6" required>
                        </div>
                        <div>
                            <label for="fontSizeLevel2">Font Size Level 2</label>
                            <input type="number" id="fontSizeLevel2" value="8" min="6" required>
                        </div>
                    </div>
                    <div class="row">
                        <div>
                            <label for="colorFillLevel1">Fill Color Level 1</label>
                            <input type="color" id="colorFillLevel1" value="#3674B5" required>
                        </div>
                        <div>
                            <label for="colorFillLevel2">Fill Color Level 2</label>
                            <input type="color" id="colorFillLevel2" value="#FADA7A" required>
                        </div>
                    </div>
                    <div class="row">
                        <div>
                            <label for="textColorLevel1">Text Color Level 1</label>
                            <input type="color" id="textColorLevel1" value="#FFFFFF" required>
                        </div>
                        <div>
                            <label for="textColorLevel2">Text Color Level 2</label>
                            <input type="color" id="textColorLevel2" value="#000000" required>
                        </div>
                    </div>
                    <div class="row">
                        <div>
                            <label for="borderColor">Border Color</label>
                            <input type="color" id="borderColor" value="#578FCA" required>
                        </div>
                        <div>
                            <label for="widthLevel2">Box Width Level 2 (inches)</label>
                            <input type="number" id="widthLevel2" value="2.7" min="0.5" step="0.1" required>
                        </div>
                        <div>
                            <label for="heightLevel2">Box Height Level 2 (inches)</label>
                            <input type="number" id="heightLevel2" value="1.0" min="0.2" step="0.1" required>
                        </div>
                    </div>
                    <div class="row">
                        <div style="width:100%">
                            <label for="fontFamily">Font Family</label>
                            <select id="fontFamily" name="fontFamily" class="bcm-font-select" required>
                                <option value="Arial" style="font-family:Arial">Arial</option>
                                <option value="Segoe UI" style="font-family:'Segoe UI'">Segoe UI</option>
                                <option value="Roboto" style="font-family:Roboto">Roboto</option>
                                <option value="Times New Roman" style="font-family:'Times New Roman'">Times New Roman</option>
                                <option value="Courier New" style="font-family:'Courier New'">Courier New</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="generate-btn generate-btn-big generate-btn-full">Generate Presentation</button>
                </form>
            </div>
        </div>
    </div>
    <div class="footer">
        Made with <span style="color:#FADA7A">&#10084;</span> for business transformation &middot; <a href="#" style="color:var(--blue1);text-decoration:none;">GitHub</a>
    </div>
    <script>
    let uploadedFile = null;

    const uploadArea = document.getElementById('uploadArea');
    const fileInput = document.getElementById('excelFile');
    const fileList = document.getElementById('fileList');

    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.classList.add('dragover');
    });
    uploadArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
    });
    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
        if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {
            fileInput.files = e.dataTransfer.files;
            handleFileSelect({ target: fileInput });
        }
    });

    function handleFileSelect(event) {
        const file = event.target.files[0];
        if (file) {
            uploadedFile = file;
            renderFileList();
        }
    }

    function renderFileList() {
        fileList.innerHTML = '';
        if (uploadedFile) {
            const ext = uploadedFile.name.split('.').pop().toLowerCase();
            let icon = '<i class="fa-solid fa-file-excel bcm-upload-file-icon"></i>';
            if (ext === 'xls' || ext === 'xlsx') icon = '<i class="fa-solid fa-file-excel bcm-upload-file-icon"></i>';
            fileList.innerHTML = `<div class="bcm-upload-file-item">${icon}<span class="bcm-upload-file-name">${uploadedFile.name}</span><button type="button" class="bcm-upload-delete-btn" onclick="removeFile()"><i class='fa fa-trash'></i></button></div>`;
        }
    }

    function removeFile() {
        uploadedFile = null;
        fileInput.value = '';
        renderFileList();
    }

    // Initial render
    renderFileList();

    async function generatePresentation(event) {
        event.preventDefault();
        if (!uploadedFile) {
            alert('Please upload an Excel file.');
            return;
        }
        const formData = new FormData();
        formData.append('fontSizeLevel1', document.getElementById('fontSizeLevel1').value);
        formData.append('fontSizeLevel2', document.getElementById('fontSizeLevel2').value);
        formData.append('colorFillLevel1', document.getElementById('colorFillLevel1').value);
        formData.append('colorFillLevel2', document.getElementById('colorFillLevel2').value);
        formData.append('textColorLevel1', document.getElementById('textColorLevel1').value);
        formData.append('textColorLevel2', document.getElementById('textColorLevel2').value);
        formData.append('borderColor', document.getElementById('borderColor').value);
        formData.append('widthLevel2', document.getElementById('widthLevel2').value);
        formData.append('heightLevel2', document.getElementById('heightLevel2').value);
        formData.append('fontFamily', document.getElementById('fontFamily').value);
        formData.append('excelFile', uploadedFile);
        try {
            const response = await fetch('/generate', {
                method: 'POST',
                body: formData
            });
            const result = await response.json();
            if (response.ok) {
                alert(result.message);
            } else {
                alert(result.message + (result.error ? ('\n' + result.error) : ''));
            }
            console.log(result);
        } catch (err) {
            alert('Network or server error.');
            console.error(err);
        }
    }
    </script>
</body>
</html>
